<div class="view-wrapper list-page">
  <dx-data-grid
    class="grid theme-dependent"
    [dataSource]="Datasource"
    [showBorders]="true"
    [rowAlternationEnabled]="true"
    rowAlternationInterval="2"
    [allowColumnReordering]="true"
    [allowColumnResizing]="true"
    (onRowRemoved)="delete_Data($event)"
    (onExporting)="onExporting($event)"
    [loadPanel]="{
      enabled: true,
      text: 'Loading...',
      showIndicator: true,
      showPane: true
    }"
    [height]="'80vh'"
    noDataText=" "
    [pager]="{
      showInfo: true,
      infoText: 'Page {0} of {1}',
      showNavigationButtons: true
    }"
    (onEditingStart)="onEditingStart($event)"
  >
    <dxo-export [enabled]="true" [formats]="['xlsx', 'pdf']"> </dxo-export>

    <dxo-header-filter [visible]="true">
      <dxo-search [enabled]="true"></dxo-search>
    </dxo-header-filter>

    <dxo-paging [pageSize]="10"></dxo-paging>
    <dxo-pager
      [visible]="true"
      [showPageSizeSelector]="true"
      [allowedPageSizes]="[10, 20, 30, 40]"
    ></dxo-pager>

    <dxo-editing
      mode="popup"
      [allowUpdating]="canEdit"
       [allowDeleting]="canDelete"
      [allowAdding]="true"
    >
      <dxo-popup
        title="Update Department"
        [showTitle]="true"
        [width]="600"
        [height]="300"
      ></dxo-popup>
    </dxo-editing>

    <dxo-search-panel
      [visible]="true"
      placeholder="Data Search"
    ></dxo-search-panel>

    <dxo-toolbar>
      <dxi-item location="before" locateInMenu="never">
        <div class="grid-header">Dealers</div>
      </dxi-item>

      <dxi-item location="after" locateInMenu="never">
        <dx-button
          text=""
          icon="plus"
          type="default"
          stylingMode="contained"
          *ngIf="canAdd"
          (onClick)="addDealers()"
        ></dx-button>
      </dxi-item>

      <!-- Enable export options -->
      <dxi-item name="exportButton"> </dxi-item>

      <dxi-item name="searchPanel" locateInMenu="never"></dxi-item>
    </dxo-toolbar>

    <!-- This field ID optional .Used for displaying data temp -->
    <dxi-column
      dataField="SlNo"
      [width]="80"
      caption="Sl.No"
      [allowFiltering]="false"
      [allowEditing]="false"
      alignment="left"
      [allowHeaderFiltering]="false"
    ></dxi-column>
    <dxi-column dataField="CODE" caption="Code"></dxi-column>

    <dxi-column dataField="DISTRIBUTOR_NAME" caption="Dealer"></dxi-column>

    <dxi-column
      [calculateCellValue]="getDealerTypeName"
      caption="Dealer Type"
    ></dxi-column>

    <dxi-column dataField="STATE_NAME" caption="State"></dxi-column>

    <dxi-column
      dataField="IS_INACTIVE"
      caption="Status"
      cellTemplate="statusCellTemplate"
    ></dxi-column>
    <div *dxTemplate="let cellData of 'statusCellTemplate'">
      <i
        class="fas fa-flag"
        [ngClass]="getStatusFlagClass(cellData.value)"
        [attr.title]="cellData.value"
        style="margin-left: 10px; cursor: default"
      ></i>
    </div>
  </dx-data-grid>
</div>

<!-- Add Form -->
<dx-popup
  [(visible)]="addPopup"
  [width]="670"
  height="620"
  title="New Dealer"
  [shading]="false"
  [showCloseButton]="true"
  (onHiding)="onAddPopupClose()"
  [shading]="true"
  [hideOnOutsideClick]="false"
>


  <!-- INPUT FIELD -->
  <dx-tab-panel
    [(selectedIndex)]="selectedTabIndex"
    [animationEnabled]="true"
    [width]="600"
  >
    <dxi-item title="Basic">
      <div class="tab-content tab-basic">
        <dx-validation-group #formValidationGroup>
          <dx-form [formGroup]="formsource" width="580" class="mt-3">
            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-select-box
                  #dealerTypeBoxRef
                  label="Dealer Type"
                  labelMode="floating"
                  alignment="center"
                  [items]="DealerType"
                  [(value)]="SelectedDealer"
                  formControlName="DealerType"
                  valueExpr="ID"
                  displayExpr="Name"
                  [searchEnabled]="true"
                  (onValueChanged)="onDealerTypeChange($event)"
                  (onKeyDown)="onKeyDownHandler($event, 'dealerCodeBoxRef')"
                >
                  <dx-validator>
                    <dxi-validation-rule
                      type="required"
                      message="DealerType is required"
                    ></dxi-validation-rule> </dx-validator
                ></dx-select-box>
              </dxi-item>

              <dxi-item>
                <dx-select-box
                  #dealerTypeBoxRef
                  label="Distributor Name"
                  labelMode="floating"
                  [visible]="SelectedDealer === 1"
                  alignment="center"
                  valueExpr="ID"
                  formControlName="DistributorID"
                  [searchEnabled]="true"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'dealerCodeBoxRef')"
                  [items]="Distributor"
                  (onValueChanged)="onDistributorValue($event)"
                  [(value)]="selectedDistributorId"
                ></dx-select-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #dealerCodeBoxRef
                  type="text"
                  formControlName="Code"
                  class="form-control mt-1"
                  label="Dealer Code"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'dealerNameBoxRef')"
                >
              <dx-validator>
                    <dxi-validation-rule
                      type="required"
                      message="Dealer Code is required"
                    ></dxi-validation-rule> </dx-validator
                >
              </dx-text-box>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #dealerNameBoxRef
                  type="text"
                  formControlName="DistributorName"
                  class="form-control mt-1"
                  label="Dealer Name"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'contactNameBoxRef')"
                >
              <dx-validator>
                    <dxi-validation-rule
                      type="required"
                      message="DealerName is required"
                    ></dxi-validation-rule> </dx-validator></dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #contactNameBoxRef
                  type="text"
                  formControlName="ContactName"
                  class="form-control mt-1"
                  label="Contact Name"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'addressBoxRef')"
                ></dx-text-box>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #addressBoxRef
                  type="text"
                  formControlName="Address"
                  class="form-control mt-1"
                  label="Address"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'mobileBoxRef')"
                ></dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #mobileBoxRef
                  type="text"
                  formControlName="Mobile"
                  class="form-control mt-1"
                  label="Mobile"
                  labelMode="floating"
                   (input)="validateMobile($event)"
                  (onKeyDown)="onKeyDownHandler($event, 'telephoneBoxRef')"
                ></dx-text-box>
                <div *ngIf="mobileError" class="error-message">
                    {{ mobileError }}
                  </div>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #telephoneBoxRef
                  type="text"
                  formControlName="Telephone"
                  class="form-control mt-1"
                  label="Telephone"
                  labelMode="floating"
                  
                  (onKeyDown)="onKeyDownHandler($event, 'countryBoxRef')"
                ></dx-text-box>
                <!-- <div *ngIf="mobileError" class="error-message">
                    {{ mobileError }}
                  </div> -->
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-select-box
                  #countryBoxRef
                  label="Country"
                  labelMode="floating"
                  alignment="center"
                  [dataSource]="countries"
                  [items]="Country"
                  [(value)]="selectedCountryId"
                  (onValueChanged)="onCountryValue($event)"
                  formControlName="Country"
                  valueExpr="ID"
                  [searchEnabled]="true"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'stateBoxRef')"
                >
            </dx-select-box>
              </dxi-item>

              <dxi-item>
                <dx-select-box
                  #stateBoxRef
                  label="State"
                  labelMode="floating"
                  alignment="center"
                  formControlName="State"
                  [items]="State"
                  valueExpr="ID"
                  [searchEnabled]="true"
                  (onValueChanged)="onStateValue($event)"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'districtBoxRef')"
                ></dx-select-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <div class="inline-select-button">
                  <dx-select-box
                    #districtBoxRef
                    label="District"
                    labelMode="floating"
                    alignment="center"
                    (onValueChanged)="onDistrictValue($event)"
                    formControlName="DistrictID"
                    [items]="District"
                    valueExpr="ID"
                    [searchEnabled]="true"
                    displayExpr="DESCRIPTION"
                    [width]="240"
                    (onKeyDown)="onKeyDownHandler($event, 'cityBoxRef')"
                  ></dx-select-box>

                  <dx-button
                    text=""
                    icon="plus"
                    type="default"
                    stylingMode="contained"
                    [width]="30"
                    height="30"
                    (onClick)="addNewDisctrict()"
                  ></dx-button>
                </div>
              </dxi-item>

              <dxi-item>
                <div class="inline-select-button">
                  <dx-select-box
                    #cityBoxRef
                    label="City"
                    labelMode="floating"
                    alignment="center"
                    formControlName="CityID"
                    [items]="City"
                    [searchEnabled]="true"
                    valueExpr="ID"
                    displayExpr="DESCRIPTION"
                    [width]="240"
                    (onKeyDown)="onKeyDownHandler($event, 'whatsAppBoxRef')"
                    (onValueChanged)="onCityValueChanged($event)"
                  ></dx-select-box>

                  <dx-button
                    text=""
                    icon="plus"
                    type="default"
                    [width]="30"
                    height="30"
                    stylingMode="contained"
                    (onClick)="addNewCity()"
                  ></dx-button>
                </div>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #whatsAppBoxRef
                  type="text"
                  formControlName="WhatsApp"
                  class="form-control mt-1"
                  label="Whatsapp No"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'faxBoxRef')"
                ></dx-text-box>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #faxBoxRef
                  type="text"
                  formControlName="Fax"
                  class="form-control mt-1"
                  label="Fax"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'emailBoxRef')"
                ></dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #emailBoxRef
                  type="text"
                  formControlName="Email"
                  class="form-control mt-1"
                  label="Email"
                  labelMode="floating"
                  (input)="validateEmail($event)"
                  (onKeyDown)="onKeyDownHandler($event, 'salesmanEmailBoxRef')"
                ></dx-text-box>
                <div *ngIf="emailError" class="error-message">
                    {{ emailError }}
                  </div>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #salesmanEmailBoxRef
                  type="text"
                  formControlName="SalesmanEmail"
                  class="form-control mt-1"
                  label="Salesman Email"
                  labelMode="floating"
                
                  (onKeyDown)="onKeyDownHandler($event, 'warehouseBoxRef')"
                ></dx-text-box>
                <!-- <div *ngIf="emailError" class="error-message">
                    {{ emailError }}
                  </div> -->
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-select-box
                  #warehouseBoxRef
                  label="Warehouse"
                  labelMode="floating"
                  [searchEnabled]="true"
                  alignment="center"
                  formControlName="Warehouse"
                  valueExpr="ID"
                  (onValueChanged)="onWarehouseValue($event)"
                  [items]="Warehouse"
                  [(value)]="selectedWarehouseId"
                  (onKeyDown)="onKeyDownHandler($event, 'zoneBoxRef')"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'zoneBoxRef')"
                ></dx-select-box>
              </dxi-item>
              <dxi-item>
                <dx-select-box
                  #zoneBoxRef
                  label="Zone"
                  labelMode="floating"
                  [searchEnabled]="true"
                  alignment="center"
                  formControlName="Zone"
                  valueExpr="ID"
                  (onValueChanged)="onZoneValue($event)"
                  [items]="Zone"
                  [(value)]="selectedZoneId"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'userNameBoxRef')"
                ></dx-select-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #userNameBoxRef
                  type="text"
                  formControlName="UserName"
                  class="form-control mt-1"
                  label="User Name"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'passwordBoxRef')"
                ></dx-text-box>
              </dxi-item>

              <dxi-item [editorOptions]="{ mode: 'password' }">
                <dx-text-box
                  #passwordBoxRef
                  formControlName="Password"
                  label="Password"
                  labelMode="floating"
                  class="form-control mt-1"
                  [height]="35"
                  [inputAttr]="{ autocomplete: 'new-password' }"
                  [mode]="passwordMode"
                  (onKeyDown)="onKeyDownHandler($event, 'creditLimitBoxRef')"
                  [buttons]="[
                    {
                      name: 'togglePassword',
                      location: 'after',
                      options: {
                        icon:
                          passwordMode === 'password'
                            ? 'fas fa-eye'
                            : 'fas fa-eye-slash',
                        stylingMode: 'text',
                        onClick: togglePasswordVisibility
                      }
                    }
                  ]"
                >
                </dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="3" [colSpan]="3">
              <dxi-item>
                <dx-number-box
                  #creditLimitBoxRef
                  type="text"
                  formControlName="CreditLimit"
                  class="form-control mt-1"
                  label="Credit Limit"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'creditDaysBoxRef')"
                ></dx-number-box>
              </dxi-item>

              <dxi-item>
                <dx-number-box
                  #creditDaysBoxRef
                  type="text"
                  formControlName="CreditDays"
                  class="form-control mt-1"
                  label="Credit Days"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'discountBoxRef')"
                ></dx-number-box>
              </dxi-item>

              <dxi-item>
                <dx-number-box
                  #discountBoxRef
                  type="text"
                  formControlName="Discount"
                  class="form-control mt-1"
                  label="Discount(%)"
                  labelMode="floating"
                ></dx-number-box>
              </dxi-item>
            </dxi-item>
          </dx-form>
        </dx-validation-group>
      </div>
    </dxi-item>

    <!-- SECOND TAB -->
    <dxi-item title="Delivery Address">
      <div class="tab-content tab-delivery-address">
        <dx-form [formGroup]="formsource" width="580">
          <dxi-item>
            <dx-text-box
              #locationBoxRef
              type="text"
              formControlName="Location"
              class="form-control mt-1"
              label="Location"
              labelMode="floating"
              (onKeyDown)="onKeyDownHandler($event, 'addressRef')"
            ></dx-text-box>
          </dxi-item>

          <dxi-item>
            <dx-text-box
              #addressRef
              type="text"
              formControlName="AddressDelivery"
              class="form-control mt-1"
              label="Address"
              labelMode="floating"
              (onKeyDown)="onKeyDownHandler($event, 'mobileRef')"
            ></dx-text-box>
          </dxi-item>

          <dxi-item>
            <dx-text-box
              #mobileRef
              type="text"
              formControlName="MobileDelivery"
              class="form-control mt-1"
              label="Mobile"
              labelMode="floating"
              (onKeyDown)="onKeyDownHandler($event, 'telephoneRef')"
            ></dx-text-box>
          </dxi-item>

          <dxi-item>
            <dx-text-box
              #telephoneRef
              type="text"
              formControlName="TelephoneDelivery"
              class="form-control mt-1"
              label="Telephone"
              labelMode="floating"
              (onKeyDown)="onKeyDownHandler($event, 'locationBoxRef')"
            ></dx-text-box>
          </dxi-item>
        </dx-form>
      </div>
    </dxi-item>
  </dx-tab-panel>
  <!-- BUTTONS -->
  <div class="form-popup-buttons-container">
    <div class="popup-footer">
      <dx-button
        class="btn me-1 border border-1 equal-button"
        (click)="closePop()"
      >
        Cancel
      </dx-button>
      <dx-button
        class="equal-button"
        text="Save"
        type="default"
        stylingMode="contained"
        (onClick)="addData()"
      ></dx-button>
    </div>
  </div>
</dx-popup>

<!-- Edit Form -->

<dx-popup
  [(visible)]="editPopup"
  [width]="670"
  height="600"
  title="Update Dealer"
  [shading]="false"
  [showCloseButton]="true"
  (onHiding)="onAddPopupClose()"
  [shading]="true"
  [hideOnOutsideClick]="false"
>
<dx-load-panel
  [visible]="isEditPopupLoading"
  [showIndicator]="true"
  [showPane]="true"
  [shading]="true"
  [position]="{ of: '#editPopupContainer' }"
  message="Loading..."
></dx-load-panel>
<div id="editPopupContainer" *ngIf="!isEditPopupLoading">

  <!-- INPUT FIELD -->
  <dx-tab-panel
    [(selectedIndex)]="selectedTabIndex"
    [animationEnabled]="true"
    [width]="600"
  >
    <dxi-item title="Basic">
      <div class="tab-content tab-basic">
        <dx-validation-group #formValidationGroup>
          <dx-form [formGroup]="formsource" width="580" class="mt-3">
            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-select-box
                  #dealerTypeBoxRef
                  label="Dealer Type"
                  labelMode="floating"
                  alignment="center"
                  [items]="DealerType"
                  [(value)]="SelectedDealer"
                  valueExpr="ID"
                  displayExpr="Name"
                  [searchEnabled]="true"
                  (onValueChanged)="onDealerTypeChange($event)"
                  (onKeyDown)="onKeyDownHandler($event, 'dealerCodeBoxRef')"
                >
              <dx-validator>
                    <dxi-validation-rule
                      type="required"
                      message="DealerType is required"
                    ></dxi-validation-rule> </dx-validator
                >
              </dx-select-box>
              </dxi-item>

              <dxi-item>
                <dx-select-box
                  #dealerTypeBoxRef
                  label="Distributor Name"
                  labelMode="floating"
                  [visible]="SelectedDealer === 1"
                  alignment="center"
                  valueExpr="ID"
                  [searchEnabled]="true"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'dealerCodeBoxRef')"
                  [items]="Distributor"
                  (onValueChanged)="onDistributorValue($event)"
                  [(value)]="distributerid"
                ></dx-select-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #dealerCodeBoxRef
                  type="text"
                  formControlName="Code"
                  class="form-control mt-1"
                  label="Dealer Code"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'dealerNameBoxRef')"
                >
              <dx-validator>
                    <dxi-validation-rule
                      type="required"
                      message="DealerCode is required"
                    ></dxi-validation-rule> </dx-validator
                ></dx-text-box>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #dealerNameBoxRef
                  type="text"
                 formControlName="DistributorName"
                  class="form-control mt-1"
                  label="Dealer Name"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'contactNameBoxRef')"
                >
              <dx-validator>
                    <dxi-validation-rule
                      type="required"
                      message="Dealer Name is required"
                    ></dxi-validation-rule> </dx-validator
                ></dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #contactNameBoxRef
                  type="text"
                  formControlName="ContactName"
                  class="form-control mt-1"
                  label="Contact Name"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'addressBoxRef')"
                ></dx-text-box>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #addressBoxRef
                  type="text"
                  formControlName="Address"
                  class="form-control mt-1"
                  label="Address"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'mobileBoxRef')"
                ></dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #mobileBoxRef
                  type="text"
                  formControlName="Mobile"
                  class="form-control mt-1"
                  label="Mobile"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'telephoneBoxRef')"
                ></dx-text-box>
                <div *ngIf="mobileError" class="error-message">
                    {{ mobileError }}
                  </div>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #telephoneBoxRef
                  type="text"
                 formControlName="Telephone"
                  class="form-control mt-1"
                  label="Telephone"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'countryBoxRef')"
                ></dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-select-box
                  #countryBoxRef
                  label="Country"
                  labelMode="floating"
                  alignment="center"
                  [items]="Country"
                  [(value)]="selectedCountryId"
                  (onValueChanged)="onCountryValue($event)"
                  formControlName="Country"
                  valueExpr="ID"
                  [searchEnabled]="true"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'stateBoxRef')"
                ></dx-select-box>
              </dxi-item>

              <dxi-item>
                <dx-select-box
                  #stateBoxRef
                  label="State"
                  labelMode="floating"
                  alignment="center"
                  formControlName="State"
                  [items]="State"
                  [searchEnabled]="true"
                  valueExpr="ID"
                  (onValueChanged)="onStateValue($event)"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'districtBoxRef')"
                ></dx-select-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <div class="inline-select-button">
                  <dx-select-box
                    #districtBoxRef
                    label="District"
                    labelMode="floating"
                    alignment="center"
                    (onValueChanged)="onDistrictValue($event)"
                    [(value)]="distric_id_value"
                    [items]="District"
                    [searchEnabled]="true"
                    valueExpr="ID"
                    displayExpr="DESCRIPTION"
                    [width]="240"
                    (onKeyDown)="onKeyDownHandler($event, 'cityBoxRef')"
                  ></dx-select-box>

                  <dx-button
                    text=""
                    icon="plus"
                    type="default"
                    stylingMode="contained"
                    [width]="30"
                    height="30"
                    (onClick)="addNewDisctrict()"
                  ></dx-button>
                </div>
              </dxi-item>

              <dxi-item>
                <div class="inline-select-button">
                  <dx-select-box
                    #cityBoxRef
                    label="City"
                    labelMode="floating"
                    alignment="center"
                    [(value)]="city_id_value"
                    [items]="City"
                    valueExpr="ID"
                    displayExpr="DESCRIPTION"
                    [width]="240"
                    [searchEnabled]="true"
                    (onKeyDown)="onKeyDownHandler($event, 'whatsAppBoxRef')"
                  ></dx-select-box>

                  <dx-button
                    text=""
                    icon="plus"
                    type="default"
                    [width]="30"
                    height="30"
                    stylingMode="contained"
                    (onClick)="addNewCity()"
                  ></dx-button>
                </div>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #whatsAppBoxRef
                  type="text"
                  formControlName="WhatsApp"
                  class="form-control mt-1"
                  label="Whatsapp No"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'faxBoxRef')"
                ></dx-text-box>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #faxBoxRef
                  type="text"
                  formControlName="Fax"
                  class="form-control mt-1"
                  label="Fax"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'emailBoxRef')"
                ></dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #emailBoxRef
                  type="text"
                  formControlName="Email"
                  class="form-control mt-1"
                  label="Email"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'salesmanEmailBoxRef')"
                ></dx-text-box>
                  <div *ngIf="emailError" class="error-message">
                    {{ emailError }}
                  </div>
              </dxi-item>

              <dxi-item>
                <dx-text-box
                  #salesmanEmailBoxRef
                  type="text"
                   formControlName="SalesmanEmail"
                  class="form-control mt-1"
                  label="Salesman Email"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'warehouseBoxRef')"
                ></dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-select-box
                  #warehouseBoxRef
                  label="Warehouse"
                  labelMode="floating"
                  alignment="center"
                  formControlName="Warehouse"
                  valueExpr="ID"
                  (onValueChanged)="onWarehouseValue($event)"
                  [items]="Warehouse"
                  [(value)]="selectedWarehouseId"
                  [searchEnabled]="true"
                  (onKeyDown)="onKeyDownHandler($event, 'zoneBoxRef')"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'zoneBoxRef')"
                ></dx-select-box>
              </dxi-item>
              <dxi-item>
                <dx-select-box
                  #zoneBoxRef
                  label="Zone"
                  labelMode="floating"
                  alignment="center"
                 formControlName="Zone"
                  valueExpr="ID"
                  (onValueChanged)="onZoneValue($event)"
                  [items]="Zone"
                  [searchEnabled]="true"
                  [(value)]="selectedZoneId"
                  displayExpr="DESCRIPTION"
                  (onKeyDown)="onKeyDownHandler($event, 'userNameBoxRef')"
                ></dx-select-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="2" [colSpan]="2">
              <dxi-item>
                <dx-text-box
                  #userNameBoxRef
                  type="text"
                  formControlName="UserName"
                  class="form-control mt-1"
                  label="User Name"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'passwordBoxRef')"
                ></dx-text-box>
              </dxi-item>

              <dxi-item [editorOptions]="{ mode: 'password' }">
                <dx-text-box
                  #passwordBoxRef
                  formControlName="Password"
                  label="Password"
                  labelMode="floating"
                  class="form-control mt-1"
                  [height]="35"
                  [inputAttr]="{ autocomplete: 'new-password' }"
                  [mode]="passwordMode"
                  (onKeyDown)="onKeyDownHandler($event, 'creditLimitBoxRef')"
                  [buttons]="[
                    {
                      name: 'togglePassword',
                      location: 'after',
                      options: {
                        icon:
                          passwordMode === 'password'
                            ? 'fas fa-eye'
                            : 'fas fa-eye-slash',
                        stylingMode: 'text',
                        onClick: togglePasswordVisibility
                      }
                    }
                  ]"
                >
                </dx-text-box>
              </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" [colCount]="3" [colSpan]="3">
              <dxi-item>
                <dx-number-box
                  #creditLimitBoxRef
                  type="text"
                  formControlName="CreditLimit"
                  class="form-control mt-1"
                  label="Credit Limit"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'creditDaysBoxRef')"
                ></dx-number-box>
              </dxi-item>

              <dxi-item>
                <dx-number-box
                  #creditDaysBoxRef
                  type="text"
                  formControlName="CreditDays"
                  class="form-control mt-1"
                  label="Credit Days"
                  labelMode="floating"
                  (onKeyDown)="onKeyDownHandler($event, 'discountBoxRef')"
                ></dx-number-box>
              </dxi-item>

              <dxi-item>
                <dx-number-box
                  #discountBoxRef
                  type="text"
                   formControlName="Discount"
                  class="form-control mt-1"
                  label="Discount(%)"
                  labelMode="floating"
                ></dx-number-box>
              </dxi-item>
            </dxi-item>
            <dxi-item class="checkbox-row">
                <dx-check-box
                  formControlName="Inactive"
                  class="mt-2"
                  [elementAttr]="{ 'aria-label': 'Unchecked' }"
                  id="checkboxadd"
                ></dx-check-box>
                <label for="checboxadd" class="me-3">Inactive</label>
              </dxi-item>
          </dx-form>
        </dx-validation-group>
      </div>
    </dxi-item>

    <!-- SECOND TAB -->
    <dxi-item title="Delivery Address">
      <div class="tab-content tab-delivery-address">
        <dx-form [formGroup]="formsource" width="580">
          <dxi-item>
            <dx-text-box
              #locationBoxRef
              type="text"
              formControlName="Location"
              class="form-control mt-1"
              label="Location"
              labelMode="floating"
              (onKeyDown)="onKeyDownHandler($event, 'addressRef')"
            ></dx-text-box>
          </dxi-item>

          <dxi-item>
            <dx-text-box
              #addressRef
              type="text"
              class="form-control mt-1"
              label="Address"
              labelMode="floating"
              formControlName="AddressDelivery"
              (onKeyDown)="onKeyDownHandler($event, 'mobileRef')"
            ></dx-text-box>
          </dxi-item>

          <dxi-item>
            <dx-text-box
              #mobileRef
              type="text"
              formControlName="MobileDelivery"
              class="form-control mt-1"
              label="Mobile"
              labelMode="floating"
              (onKeyDown)="onKeyDownHandler($event, 'telephoneRef')"
            ></dx-text-box>
          </dxi-item>

          <dxi-item>
            <dx-text-box
              #telephoneRef
              type="text"
              formControlName="TelephoneDelivery"
              class="form-control mt-1"
              label="Telephone"
              labelMode="floating"
              (onKeyDown)="onKeyDownHandler($event, 'locationBoxRef')"
            ></dx-text-box>
          </dxi-item>

          <!-- ACTIVE CHECKBOX -->
            
              <!-- <dxi-item class="checkbox-row">
                <dx-check-box
                  formControlName="Inactive"
                  class="mt-2"
                  [elementAttr]="{ 'aria-label': 'Unchecked' }"
                  id="checkboxadd"
                ></dx-check-box>
                <label for="checboxadd" class="me-3">Inactive</label>
              </dxi-item> -->
              
        </dx-form>
      </div>
    </dxi-item>
  </dx-tab-panel>
  <!-- BUTTONS -->
  <div class="form-popup-buttons-container">
    <div class="popup-footer">
      <dx-button
        class="btn me-1 border border-1 equal-button"
        (click)="closePop()"
      >
        Cancel
      </dx-button>
      <dx-button
        class="equal-button"
        text="Save"
        type="default"
        stylingMode="contained"
        (onClick)="editData()"
      ></dx-button>
    </div>
  </div>
  </div>
</dx-popup>

<dx-popup
  [(visible)]="newPopupDistrict"
  [width]="300"
  height="220"
  title="Add New District"
  [shading]="false"
  (onHiding)="onAddPopupClose()"
  [showCloseButton]="true"
  [shading]="true"
  [hideOnOutsideClick]="false"
>
<dx-validation-group #newformValidationGroup>
          <dx-form [formGroup]="districtformsource" class="mt-3">
  <dxi-item>
    <dx-text-box
      type="text"
      class="form-control mt-1"
      label="Name"
      formControlName="District"
      labelMode="floating"
    >
  <dx-validator>
                    <dxi-validation-rule
                      type="required"
                      message="District Name is required"
                    ></dxi-validation-rule> </dx-validator
                ></dx-text-box>
  </dxi-item>
</dx-form>
</dx-validation-group>

  <div class="form-popup-buttons-container">
    <div class="popup-footer">
      <dx-button
        class="btn me-1 border border-1 equal-button"
         (click)="DistrictClosePopup()"
      >
        Cancel
      </dx-button>
      <dx-button
        class="equal-button"
        text="Save"
        type="default"
        stylingMode="contained"
        (onClick)="DisctrictData()"
      ></dx-button>
    </div>
  </div>
</dx-popup>

<dx-popup
  [(visible)]="newPopupCity"
  [width]="310"
  height="270"
  title="Add New City"
  [shading]="false"
  (onHiding)="onAddPopupClose()"
  [showCloseButton]="true"
  [shading]="true"
  [hideOnOutsideClick]="false"
>

<dx-validation-group #newformValidationGroup>
          <dx-form [formGroup]="formsource" class="mt-3">
  <dxi-item>
    <dx-text-box
      type="text"
      class="form-control mt-1"
      label="Name"
      labelMode="floating"
      formControlName="City"
      (onKeyDown)="onKeyDownHandler($event, 'dealerNameBoxRef')"
    >
  <dx-validator>
                    <dxi-validation-rule
                      type="required"
                      message="City Name is required"
                    ></dxi-validation-rule> </dx-validator
                ></dx-text-box>
  </dxi-item>

  <dxi-item>
    <dx-text-box
      type="text"
      class="form-control mt-1"
      label="STD CODE"
      formControlName="StdCode"
      labelMode="floating"
      (onKeyDown)="onKeyDownHandler($event, 'dealerNameBoxRef')"
    >
  <dx-validator>
                    <dxi-validation-rule
                      type="required"
                      message="STD CODE is required"
                    ></dxi-validation-rule> </dx-validator
                ></dx-text-box>
  </dxi-item>
</dx-form>
</dx-validation-group>


  <div class="form-popup-buttons-container">
    <div class="popup-footer">
      <dx-button class="btn me-1 border border-1 equal-button"
     (click) ="CityClosePopup()">
        Cancel
      </dx-button>
      <dx-button
        class="equal-button"
        text="Save"
        type="default"
        stylingMode="contained"
        (onClick)="CityData()"
      ></dx-button>
    </div>
  </div>
</dx-popup>
