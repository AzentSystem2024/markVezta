<div class="salary-grid-wrapper">
  <div class="grid-container">
    <dx-data-grid
      [dataSource]="payRollData.PAY_DETAILS"
      [showBorders]="true"
      [columnAutoWidth]="false"
      [wordWrapEnabled]="false"
      [rowAlternationEnabled]="true"
      [headerFilter]="{ visible: true }"
      [allowColumnReordering]="true"
      [showColumnHeaders]="true"
      [columnAutoWidth]="true"
      [allowColumnResizing]="true"
      [height]="'50vh'"
      [columnResizingMode]="'nextColumn'"
      [headerFilter]="{ visible: true }"
      [scrolling]="{ mode: 'virtual' }"
      rowAlternationInterval="2"
      [selection]="{ mode: 'single' }"
      [editing]="{ mode: 'cell', allowUpdating: true }"
      (onEditorPreparing)="onEditorPreparing($event)"
      (onContentReady)="onContentReady($event)"
    >
      <dxo-load-panel [showPane]="false"></dxo-load-panel>
      <dxo-scrolling mode="standard"></dxo-scrolling>
      <!-- <dxo-filter-row [visible]="showFilterRow"></dxo-filter-row> -->
      <dxo-filter-builder [allowHierarchicalFields]="true">
      </dxo-filter-builder>
      <dxo-toolbar>
        <dxi-item location="before" locateInMenu="auto">
          <div class="stacked-toolbar-group">
            <dx-text-box
              class="custom-select-box"
              [placeholder]="'Select Employee'"
              label="Salary Month"
              [labelMode]="'floating'"
              [(value)]="payRollData.SAL_MONTH"
              [readOnly]="true"
            ></dx-text-box>
            <dx-text-box
              class="custom-text-box"
              [placeholder]="'Employee '"
              label="Employee"
              [labelMode]="'floating'"
              [(value)]="payRollData.EMP_NAME"
              [width]="200"
              [readOnly]="true"
            ></dx-text-box>
          </div>
        </dxi-item>
        <dxi-item location="before" locateInMenu="auto">
          <div class="stacked-toolbar-group">
            <dx-text-box
              [showClearButton]="true"
              label="Basic Salary"
              [labelMode]="'floating'"
              [(value)]="payRollData.BASIC_PAY"
              [width]="180"
              [readOnly]="true"
            ></dx-text-box>

            <dx-number-box
            label="Allowance"
            [labelMode]="'floating'"
            [(value)]="payRollData.EMP_ALLOWANCE"
            [width]="180"
            [format]="{ type: 'fixedPoint', precision: 2 }"
          ></dx-number-box>
          </div>
        </dxi-item>

        <dxi-item location="after" locateInMenu="auto">
          <div class="stacked-toolbar-group"></div>
          <div class="stacked-toolbar-group">
            <!-- <dx-text-box
            [placeholder]="'Worked Days'"
            label="Worked Days"
            [labelMode]="'floating'"
            [(value)]="payRollData.DAYS"
            [width]="180"
            [readOnly]="true"

          ></dx-text-box> -->

            <dx-number-box
              [placeholder]="'Normal OT Hours'"
              [label]="'Normal OT Hours'"
              [labelMode]="'floating'"
              [(value)]="payRollData.NOT_HOURS"
              [width]="180"
                              [min]="0"
                [max]="12"
            ></dx-number-box>
          </div>
        </dxi-item>
        <dxi-item location="after" locateInMenu="auto">
          <div class="stacked-toolbar-group">
            <dx-text-box
              [placeholder]="'Worked Days'"
              label="Worked Days"
              [labelMode]="'floating'"
              [(value)]="payRollData.DAYS"
              [width]="180"
              [readOnly]="true"
            ></dx-text-box>
            <dx-number-box
              [placeholder]="'Holiday OT'"
              [label]="'Holiday OT'"
              [labelMode]="'floating'"
              [(value)]="payRollData.HOT_HOURS"
              [width]="180"
                              [min]="0"
                [max]="12"
            ></dx-number-box>
          </div>
        </dxi-item>
      </dxo-toolbar>
      <dxi-column dataField="HEAD_NAME" caption="Salary Head"></dxi-column>
      <dxi-column dataField="REMARKS" caption="Remarks"></dxi-column>
      <dxi-column
        dataField="GROSS"
        caption="Gross"
        dataType="number"
        [format]="{ type: 'fixedPoint', precision: 2 }"
        [editorOptions]="{ format: '#,##0.00' }"
      ></dxi-column>
      <dxi-column
        dataField="DEDUCT"
        caption="Deduction"
        [format]="{ type: 'fixedPoint', precision: 2 }"
        dataType="number"
        [editorOptions]="{ format: '#,##0.00' }"
      ></dxi-column>
      <dxo-summary>
        <dxi-total-item
          column="GROSS"
          summaryType="sum"
          [valueFormat]="customFormat"
          displayFormat="Grand Total: {0}"
          showInColumn="GROSS"
        >
        </dxi-total-item>

        <dxi-total-item
        
          column="DEDUCT"
          summaryType="sum"
          [valueFormat]="customFormat"
          displayFormat="{0}"
          showInColumn="DEDUCT"
        >
        </dxi-total-item>
      </dxo-summary>
    </dx-data-grid>
    <div
      style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 10px;
      "
    >
      <!-- Left Section: Leave Salary and End of Service -->
      <div style="display: flex; gap: 20px; align-items: center">
        <dx-number-box
          [label]="'Leave Salary'"
          [labelMode]="'floating'"
          [(value)]="payRollData.PROVISION_LS"
          width="150"
          [format]="{ type: 'fixedPoint', precision: 2 }"
          dataType="number"
          [editorOptions]="{ format: '#,##0.00' }"
          [readOnly]="true"
        ></dx-number-box>

        <dx-number-box
          [label]="'End of Service'"
          [labelMode]="'floating'"
          [(value)]="payRollData.PROVISION_EOS"
          width="150"
          [format]="{ type: 'fixedPoint', precision: 2 }"
          dataType="number"
          [editorOptions]="{ format: '#,##0.00' }"
          [readOnly]="true"
        ></dx-number-box>
      </div>

      <!-- Right Section: Net Payable -->
      <div style="display: flex; align-items: center">
        <label style="margin-right: 10px; min-width: 100px">Net Payable:</label>
        <dx-number-box
          [value]="payRollData.NET_AMOUNT"
          [readOnly]="true"
          width="200"
          dataType="number"
          dataType="number"
          [editorOptions]="{ format: '#,##0.00' }"
          [format]="{ type: 'fixedPoint', precision: 2 }"
          [rtlEnabled]="true"
        ></dx-number-box>
      </div>
    </div>

    <div
      style="display: flex; align-items: center; gap: 20px; margin-top: 10px"
    >
      <div style="flex: 1">
        <dx-text-box
          [label]="'Remarks'"
          [labelMode]="'floating'"
          [(value)]="payRollData.REMARKS"
          style="width: 100%"
        ></dx-text-box>
      </div>
    </div>

    
  </div>
</div>

<div class="form-popup-buttons-container">
  <div class="popup-footer">
    <dx-button
      text="Cancel"
      stylingMode="outlined"
      type="normal"
      (onClick)="handleClose()"
    ></dx-button>
    <dx-button
      text="Approve"
      stylingMode="contained"
      (onClick)="approve()"
      type="default"
    ></dx-button>
  </div>
</div>
